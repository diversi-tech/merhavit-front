<div class="search-bar-container">
  <div class="top-icons">
    <!-- כפתור ההתנתקות -->
    <button class="logout-button" (click)="logout()">
      <span>Logout</span>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        height="24px"
        viewBox="0 -960 960 960"
        width="24px"
        fill="#434343"
      >
        <path
          d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v80h-80v-80H200v560h560v-80h80v80q0 33-23.5 56.5T760-120H200Zm480-160-56-56 103-104H360v-80h367L624-624l56-56 200 200-200 200Z"
        />
      </svg>
    </button>
    <!-- אייקון לב ריק (Font Awesome) -->
    <i
      class="far fa-heart"
      style="color: #434343; font-size: 3vh; width: 2vw"
      [routerLink]="['/favorites']"
    title="מועדפים"
    ></i>

    <!-- אייקון פעמון ריק (Font Awesome) -->
    <i
      class="far fa-bell"
      style="color: #434343; font-size: 3vh; width: 2vw"
    ></i>
    <button
      *ngIf="userType !== 'Student'"
      [routerLink]="'/upload-resource'"
      class="upload-button"
    >
      העלאת קובץ
    </button>
    <!-- אייקון המשתמש עם האות הראשונה -->
    <div class="user-icon" [routerLink]="['/personal-details']">
      {{ firstName }}
    </div>
  </div>

  <div class="white-box">
    <div class="white-box-icons">
      <div *ngIf="!isUserManagementComponent" class="dropdown-container">
        <div class="dropdown-header" (click)="toggleFilterOptions()">
          {{ selectedFileType === "all" ? "כל סוגי הקבצים" : selectedFileType }}
          <span class="dropdown-arrow">&#9662;</span>
        </div>
        <ul *ngIf="showFilterOptions" class="dropdown-options">
          <li (click)="onSelectFilter('all')">כל סוגי הקבצים</li>
          <li (click)="onSelectFilter('כרזה')">כרזות</li>
          <li (click)="onSelectFilter('דף עבודה')">דפי עבודה</li>
          <li (click)="onSelectFilter('איור')">איורים</li>
          <li (click)="onSelectFilter('יצירה')">יצירות</li>
          <li (click)="onSelectFilter('סרטון')">סרטונים</li>
          <li (click)="onSelectFilter('שיר')">שירים</li>
          <li (click)="onSelectFilter('ספר דיגיטלי')">ספר דיגיטלי</li>
          <li (click)="onSelectFilter('ספר להשאלה')">ספר להשאלה</li>
          <li (click)="onSelectFilter('טקסט')">טקסט</li>
        </ul>
      </div>

      <!-- אייקון פילטר -->
      <i
        (click)="toggleDetails()"
        class="fas fa-filter"
        style="color: #434343; font-size: 4vh; cursor: pointer"
      ></i>

      <div class="filter-details-container" *ngIf="showDetails">
        
        <div *ngIf="!isUserManagementComponent" class="filter-details-box">
          <!-- עמודה שנייה - צד שמאל -->
          <div class="filter-column">
            <div class="filter-row">
              <label for="file-type">סוג קובץ</label>
              <input id="file-type" type="text" placeholder="סוג קובץ"  [formControl]="typeControl"/>
            </div>
            <div class="filter-row">
              <label for="borrowable">ניתן להשאלה</label>
              <input id="borrowable" type="text" placeholder="ניתן להשאלה" [formControl]="borrowedControl" />
            </div>
            <div class="filter-row">
              <label for="language">שפה:</label>
              <input id="language" type="text" placeholder="שפה" [formControl]="languageControl" />
            </div>
            <div class="filter-row">
              <label for="subjects">נושאים</label>
              <input id="subjects" type="text" placeholder="נושאים" [formControl]="subjectControl" />
            </div>
            <div class="filter-row">
              <label for="sku">מק"ט</label>
              <input id="sku" type="text" placeholder="מקט" [formControl]="searchControl"/>
            </div>
            <div class="filter-row">
              <label for="borrow-time">משך השאלה</label>
              <input id="borrow-time" type="text" placeholder="משך השאלה" [formControl]="durationControl" />
            </div>
          </div>
          <!-- עמודה ראשונה - צד ימין -->
          <div class="filter-column">
            <div class="filter-row">
              <label for="title">כותר</label>
              <input id="title" type="text" placeholder="כותר" [formControl]="titleControl" />
            </div>
            <div class="filter-row">
              <label for="publisher">מו"ל</label>
              <input id="publisher" type="text" placeholder="מול" [formControl]="createdByControl" />
            </div>
            <div class="filter-row">
              <label for="hebrew-year">גיל</label>
              <input id="hebrew-year" type="text" placeholder="גיל" [formControl]="agesControl" />
            </div>
            <div class="filter-row">
              <label for="latin-year">שנת הוצאה לועזי</label>
              <input id="latin-year" type="text" placeholder="שנת הוצאה לועזי" [formControl]="publicationDateControl" />
            </div>
            <div class="filter-row">
              <label for="level">גיל/רמה</label>
              <input id="level" type="text" placeholder="רמה" [formControl]="levelControl" />
            </div>
            <div class="filter-row">
              <label for="new-in-database">חדש במאגר</label>
              <input id="new-in-database" type="text" placeholder="חדש במאגר" [formControl]="isnewControl" />
            </div>
          </div>
        </div>
        <!-- הצגת תיבת פילטר מותאמת -->
        <div *ngIf="isUserManagementComponent" class="filter-details-box">
          <div class="filter-column">
            <div class="filter-row">
              <label for="email">מייל</label>
              <input id="email" type="text" placeholder="מייל" [(ngModel)]="filters.email" (input)="onFilterChangeUsers()" [formControl]="searchControl" (input)="onSearch()"/>
            </div>
            <div class="filter-row">
              <label for="class">כיתה</label>
              <input id="class" type="text" placeholder="כיתה" [(ngModel)]="filters.class" (input)="onFilterChangeUsers()" [formControl]="searchControl" (input)="onSearch()"/>
            </div>
            <div class="filter-row">
              <label for="specialization">התמחות</label>
              <input id="specialization" type="text" placeholder="התמחות" [(ngModel)]="filters.specialization" (input)="onFilterChangeUsers()" [formControl]="searchControl" (input)="onSearch()"/>
            </div>
            <div class="filter-row">
              <label for="userType">תפקיד</label>
              <input id="userType" type="text" placeholder="תפקיד" [(ngModel)]="filters.userType" (input)="onFilterChangeUsers()" [formControl]="searchControl" (input)="onSearch()"/>
            </div>
          </div>
          <div class="filter-column">
            <div class="filter-row">
              <label for="first-name">שם פרטי</label>
              <input id="first-name" type="text" placeholder="שם פרטי" [(ngModel)]="filters.firstName" (input)="onFilterChangeUsers()" [formControl]="searchControl" (input)="onSearch()"/>
            </div>
            <div class="filter-row">
              <label for="last-name">שם משפחה</label>
              <input id="last-name" type="text" placeholder="שם משפחה" [(ngModel)]="filters.lastName" (input)="onFilterChangeUsers()" [formControl]="searchControl" (input)="onSearch()" />
            </div>
            <div class="filter-row">
              <label for="id-number">תעודת זהות</label>
              <input id="id-number" type="text" placeholder="תעודת זהות" [(ngModel)]="filters.idNumber" (input)="onFilterChangeUsers()" [formControl]="searchControl" (input)="onSearch()"/>
            </div>
            <div class="filter-row">
              <label for="address">כתובת</label>
              <input id="address" type="text" placeholder="כתובת" [(ngModel)]="filters.address" (input)="onFilterChangeUsers()" [formControl]="searchControl" (input)="onSearch()"/>
            </div>
            <div class="filter-row">
              <label for="phone">טלפון</label>
              <input id="phone" type="text" placeholder="טלפון" [(ngModel)]="filters.phone" (input)="onFilterChangeUsers()" [formControl]="searchControl" (input)="onSearch()"/>
            </div>
          </div>
        </div>
      </div>
    </div>

  
    <div class="search-input-container">
      <!-- חיפוש כללי -->
      <div *ngIf="!isUserManagementComponent">
      
        
        <!-- תיבת היסטוריית החיפושים -->
        <div class="search-history-box" *ngIf="isSearchHistoryVisible">
          <div
            *ngFor="let item of searchResults"
            class="search-history-item"
            (click)="onSearch(item)"
          >
            <i class="fas fa-search"></i>
            <span>{{ item }}</span>
          </div>
        </div>
      </div>

      <div *ngIf="isUserManagementComponent" class="user-management-search">
            </div>
 <input type="text"  type="text" 
 [(ngModel)]="searchTerm" 
 (input)="onSearchChange()" class="search-input"  [formControl]="searchControl"  placeholder="הקלד מילת חיפוש..." 
 (focus)="showSearchHistory()"
 (blur)="hideSearchHistory()"/>
 <button mat-icon-button (click)="onSearch()">
  <mat-icon>search</mat-icon>
</button>
<section>
    <button mat-button (click)="onClear()">נקה הכל</button>
</section>
<mat-divider></mat-divider>
    </div>
  </div>

